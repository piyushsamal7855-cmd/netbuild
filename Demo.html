<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Netbuild Advanced JS Demo</title>
  <style>
    /* Minimal CSS only — focus is on advanced JS */
    body{font-family:system-ui,Arial;margin:0}
    header{position:sticky;top:0;background:#111;color:#fff;padding:12px 16px;display:flex;gap:12px;align-items:center}
    nav a{color:#bbb;text-decoration:none;margin-right:10px}
    nav a.active{color:#fff;font-weight:700}
    main{padding:18px;max-width:980px;margin:auto}
    section{padding:16px 0;border-bottom:1px solid #eee}
    .btn{display:inline-block;padding:10px 14px;border:1px solid #111;border-radius:10px;text-decoration:none;color:#111}
    .btn.primary{background:#111;color:#fff}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:12px}
    .card{border:1px solid #eee;border-radius:14px;padding:12px}
    .err{color:#b00020;font-size:13px}
    .ok{color:#1b7f2a;font-size:13px}
    input,textarea{width:100%;padding:10px;border:1px solid #ddd;border-radius:10px}
    label{display:block;margin:10px 0 6px}
  </style>
</head>
<body>
  <header>
    <strong id="brand">Brand</strong>
    <nav id="nav"></nav>
    <span style="margin-left:auto" id="clock"></span>
  </header>

  <main id="app"></main>

  <script type="module">
    // =========================
    // 1) CONFIG (JSON-driven site)
    // =========================
    const SITE = {
      brand: "Netbuild.in",
      whatsappNumber: "917855901395", // +91 removed, only digits
      sections: [
        { id: "home", title: "Home", type: "hero" },
        { id: "services", title: "Services", type: "services" },
        { id: "portfolio", title: "Portfolio", type: "portfolio" },
        { id: "contact", title: "Contact", type: "contact" }
      ],
      services: [
        { name: "Restaurant / Cafe Website", price: "₹10,000+", desc: "Menu, WhatsApp order, Google map, reviews." },
        { name: "Clinic Booking Website", price: "₹15,000+", desc: "Appointment form, SEO pages, trust sections." },
        { name: "Business Landing Page", price: "₹8,000+", desc: "Fast one-page conversion landing." },
        { name: "E-Commerce Setup", price: "₹25,000+", desc: "Products, payments, shipping basics." }
      ],
      portfolio: [
        { title: "Madhav Pure Veg", note: "Homepage + menu + map + WhatsApp." },
        { title: "Theos Cafe", note: "Dessert cafe landing + reviews." },
        { title: "RedAlert Live", note: "Security service landing concept." }
      ]
    };

    // =========================
    // 2) UTILITIES (advanced helpers)
    // =========================
    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => [...root.querySelectorAll(sel)];

    function escapeHTML(str) {
      return String(str).replace(/[&<>"']/g, s => ({
        "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;"
      }[s]));
    }

    function buildWhatsAppLink(number, message) {
      const text = encodeURIComponent(message);
      return `https://wa.me/${number}?text=${text}`;
    }

    function smoothScrollTo(id) {
      const el = document.getElementById(id);
      if (!el) return;
      el.scrollIntoView({ behavior: "smooth", block: "start" });
      history.replaceState(null, "", `#${id}`);
    }

    // =========================
    // 3) RENDER (component-like functions)
    // =========================
    function renderNav() {
      const nav = $("#nav");
      nav.innerHTML = SITE.sections
        .map(s => `<a href="#${s.id}" data-link="${s.id}">${escapeHTML(s.title)}</a>`)
        .join("");

      nav.addEventListener("click", (e) => {
        const a = e.target.closest("a[data-link]");
        if (!a) return;
        e.preventDefault();
        smoothScrollTo(a.dataset.link);
      });
    }

    function Hero() {
      const msg = `Hi, I want a website demo for my business.`;
      const wa = buildWhatsAppLink(SITE.whatsappNumber, msg);

      return `
        <section id="home">
          <h1>High-Conversion Websites by ${escapeHTML(SITE.brand)}</h1>
          <p>Fast, mobile-first, SEO ready — with WhatsApp order & lead capture.</p>
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
            <a class="btn primary" href="${wa}" target="_blank" rel="noopener">WhatsApp for Demo</a>
            <a class="btn" href="#services" data-jump="services">View Services</a>
          </div>
        </section>
      `;
    }

    function Services() {
      return `
        <section id="services">
          <h2>Services</h2>
          <div class="grid">
            ${SITE.services.map(s => `
              <div class="card">
                <strong>${escapeHTML(s.name)}</strong>
                <div style="margin:6px 0;color:#444">${escapeHTML(s.desc)}</div>
                <div style="font-weight:700">${escapeHTML(s.price)}</div>
                <div style="margin-top:10px">
                  <a class="btn" data-order="${escapeHTML(s.name)}" href="#">Order on WhatsApp</a>
                </div>
              </div>
            `).join("")}
          </div>
        </section>
      `;
    }

    function Portfolio() {
      return `
        <section id="portfolio">
          <h2>Portfolio</h2>
          <div class="grid">
            ${SITE.portfolio.map(p => `
              <div class="card">
                <strong>${escapeHTML(p.title)}</strong>
                <div style="margin-top:6px;color:#444">${escapeHTML(p.note)}</div>
              </div>
            `).join("")}
          </div>
        </section>
      `;
    }

    function Contact() {
      return `
        <section id="contact">
          <h2>Contact</h2>
          <form id="contactForm" novalidate>
            <label>Name</label>
            <input name="name" placeholder="Your name" required />

            <label>Phone</label>
            <input name="phone" placeholder="10 digit number" inputmode="numeric" required />

            <label>Message</label>
            <textarea name="message" rows="4" placeholder="Tell me your business type..." required></textarea>

            <div id="formStatus" style="margin:10px 0"></div>
            <button class="btn primary" type="submit">Send via WhatsApp</button>
          </form>
        </section>
      `;
    }

    function renderApp() {
      $("#brand").textContent = SITE.brand;
      $("#app").innerHTML = [Hero(), Services(), Portfolio(), Contact()].join("");

      // Jump buttons
      $$("[data-jump]").forEach(btn => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          smoothScrollTo(btn.dataset.jump);
        });
      });

      // WhatsApp order buttons auto-bind
      $$("[data-order]").forEach(btn => {
        btn.addEventListener("click", (e) => {
          e.preventDefault();
          const serviceName = btn.dataset.order;
          const msg = `Hi, I want to order: ${serviceName}. Please share demo + price.`;
          window.open(buildWhatsAppLink(SITE.whatsappNumber, msg), "_blank", "noopener");
        });
      });

      // Contact form -> WhatsApp with validation
      $("#contactForm").addEventListener("submit", (e) => {
        e.preventDefault();
        const fd = new FormData(e.currentTarget);
        const name = String(fd.get("name") || "").trim();
        const phone = String(fd.get("phone") || "").trim();
        const message = String(fd.get("message") || "").trim();

        const status = $("#formStatus");
        status.textContent = "";
        status.className = "";

        const phoneOK = /^[0-9]{10}$/.test(phone);
        if (!name || !message || !phoneOK) {
          status.textContent = "Please enter valid Name, 10-digit Phone, and Message.";
          status.className = "err";
          return;
        }

        const waMsg =
`New Lead:
Name: ${name}
Phone: ${phone}
Message: ${message}`;

        status.textContent = "Opening WhatsApp…";
        status.className = "ok";
        window.open(buildWhatsAppLink(SITE.whatsappNumber, waMsg), "_blank", "noopener");
        e.currentTarget.reset();
      });
    }

    // =========================
    // 4) ADVANCED UX: active nav + clock
    // =========================
    function setupActiveNav() {
      const links = $$("a[data-link]");
      const map = new Map(links.map(a => [a.dataset.link, a]));

      const observer = new IntersectionObserver((entries) => {
        // pick most visible section
        const visible = entries
          .filter(e => e.isIntersecting)
          .sort((a,b) => b.intersectionRatio - a.intersectionRatio)[0];

        if (!visible) return;
        links.forEach(a => a.classList.remove("active"));
        const id = visible.target.id;
        map.get(id)?.classList.add("active");
      }, { threshold: [0.2, 0.4, 0.6] });

      SITE.sections.forEach(s => {
        const el = document.getElementById(s.id);
        if (el) observer.observe(el);
      });

      // If URL has hash, scroll to it
      if (location.hash) smoothScrollTo(location.hash.replace("#",""));
    }

    function setupClock() {
      const el = $("#clock");
      const tick = () => {
        const d = new Date();
        const t = d.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
        el.textContent = t;
      };
      tick();
      setInterval(tick, 1000 * 10);
    }

    // Boot
    renderNav();
    renderApp();
    setupActiveNav();
    setupClock();
  </script>
</body>
</html>
